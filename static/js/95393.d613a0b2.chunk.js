"use strict";(self.webpackChunkn2_land=self.webpackChunkn2_land||[]).push([[95393],{58272:(e,t,r)=>{r.d(t,{X:()=>n,b:()=>i});const n=50,i=5},86524:(e,t,r)=>{r.d(t,{Ge:()=>p,WT:()=>g});var n=r(31633),i=r(19247),o=r(23701),s=r(13312),l=r(7137),a=r(1438),u=r(80963),c=r(45417),d=r(58272);function p(e,t,r){const n=1===e?10:e;return n**(r?Math.round(function(e,t){return Math.log(e)/Math.log(t)}(d.X/t,n)):0)}function g(e,t,r){var d,p;const g="number"==typeof e?null:e,h=null!==r&&void 0!==r?r:null===g||void 0===g?void 0:g.spatialReference;if(null==h||!(0,u.fn)(h)||function(e){const{isGeographic:t,isWebMercator:r}=e;return!t&&!r}(h))return(0,n.GA)(h);let v=null!==(d=null===g||void 0===g?void 0:g.x)&&void 0!==d?d:e,f=null!==(p=null===g||void 0===g?void 0:g.y)&&void 0!==p?p:t;const M=1/Math.sqrt(2);let y=v+M,S=f+M;const{isWebMercator:w,isGeographic:C}=h;let R=C&&!(0,l.TT)(h)?s.A.WGS84:h;if(w){let e=new i.A({x:v,y:f,spatialReference:h});(0,c.ci)(e,!0,e),v=e.x,f=e.y,e=new i.A({x:y,y:S,spatialReference:h}),(0,c.ci)(e,!0,e),y=e.x,S=e.y,R=s.A.WGS84}const P=new o.A({paths:[[[v,f],[y,S]]],spatialReference:R}),x=(0,a.XX)(P,10);let b;try{[b]=(0,l.l1)([x],"meters")}catch(Z){return(0,n.GA)(h)}return b}},95393:(e,t,r)=>{r.d(t,{GridSnappingEngine:()=>w});var n=r(6326),i=r(91967),o=r(76460),s=r(15941),l=r(31633),a=r(46053),u=(r(81806),r(47249),r(87990)),c=r(20664),d=r(56611),p=r(1438),g=r(68002),h=r(58272),v=r(86524),f=r(23862),M=r(70330),y=r(90836),S=r(45633);let w=class extends i.A{constructor(e){super(e),this.options=null}destroy(){this._set("options",null)}get grid(){return this.view.grid}get effectiveViewRotation(){var e,t;return null!==(e=this.grid)&&void 0!==e&&e.rotateWithMap?0:(0,s.kU)(null!==(t=this.view.rotation)&&void 0!==t?t:0)}get gridRotation(){var e,t;return(0,s.kU)(null!==(e=null===(t=this.grid)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0)}get gridCenter(){const{spatialReference:e,grid:t}=this;if(!t||!e||!(0,d.isLoadedOrLoadFor)(t.center.spatialReference,e))return null;try{var r;const n=(0,d.project)(t.center,e),i=e.isWrappable&&null!=(null===(r=this.view)||void 0===r?void 0:r.center)?(0,p.O7)(n.x,this.view.center.x,e):n.x;return(0,f.vt)(i,n.y,n.z)}catch(n){return o.A.getLogger(this).errorOnce("Grid Snapping - Failed to project grid center.",n),null}}get offsetScaleFactor(){const{pixelsPerStride:e,grid:t}=this;if(!t||!e)return 1;const{majorLineInterval:r,dynamicScaling:n}=t;return r<1?null:(0,v.Ge)(r,e,n)}get spatialReference(){return this.view.spatialReference}get gridMetersPerStride(){const{grid:e}=this;return e?(0,l.oU)(e.spacing,e.units,"meters"):null}get viewMetersPerPixel(){const{viewMetersPerSRUnit:e}=this;return null==e?null:e*(0,g.i1)(this.view.scale,this.view.spatialReference)}get viewMetersPerSRUnit(){const{spatialReference:e}=this.view;return this.gridCenter?(0,v.WT)(this.gridCenter[0],this.gridCenter[1],e):null}get pixelsPerStride(){const{gridMetersPerStride:e,viewMetersPerPixel:t}=this;return t&&e?e/t:null}get updating(){return null!=this.grid&&null!=this.spatialReference&&null==this.viewMetersPerSRUnit}async fetchCandidates(e,t,r){var n;const{options:i,view:o}=this;if(null===i||void 0===i||!i.effectiveGridEnabled||!o.grid||null!==(n=r.feature)&&void 0!==n&&n.attributes&&M.io in r.feature.attributes)return[];const s=r.coordinateHelper.arrayToPoint(e),l=i.distance*("touch"===r.pointer?i.touchSensitivityMultiplier:1);return this.fetchCandidatesSync(s,l)}fetchCandidatesSync(e,t){const r=[],{grid:n,effectiveViewRotation:i,gridRotation:o,gridCenter:s,viewMetersPerPixel:l,viewMetersPerSRUnit:a,offsetScaleFactor:u,spatialReference:c,gridMetersPerStride:p,pixelsPerStride:g}=this;if(!(n&&l&&a&&s&&c&&u&&p&&g))return r;if(!n.dynamicScaling&&g<h.b)return r;if(!(0,d.isLoadedOrLoadFor)(e.spatialReference,c))return r;const v=(0,d.project)(e,c),M=(0,f.vt)(v.x,v.y,v.z),w=C(M,-o,s,-i),b=p/a*u,Z=R(w,b,s),{shouldSnapX:G,shouldSnapY:A}=P(Z,w,t,l,a);if(!G&&!A)return[];const U=(0,f.vt)((G?Z:w)[0],(A?Z:w)[1]),W=C(U,o,s,i),X=C(Z,o,s,i);if(A){const e=x(Z,w,b,"y"),t=C(e,o,s,i);r.push(new S.o({lineStart:X,lineEnd:t,targetPoint:W,isDraped:!1}))}if(G){const e=x(Z,w,b,"x"),t=C(e,o,s,i);r.push(new S.o({lineStart:X,lineEnd:t,targetPoint:W,isDraped:!1}))}return G&&A&&r.push(new y.N(W,r[0],r[1],!1)),r}};(0,n.Cg)([(0,a.MZ)({constructOnly:!0})],w.prototype,"view",void 0),(0,n.Cg)([(0,a.MZ)()],w.prototype,"options",void 0),(0,n.Cg)([(0,a.MZ)()],w.prototype,"grid",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"effectiveViewRotation",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"gridRotation",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"gridCenter",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"offsetScaleFactor",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"spatialReference",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"gridMetersPerStride",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"viewMetersPerPixel",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"viewMetersPerSRUnit",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"pixelsPerStride",null),(0,n.Cg)([(0,a.MZ)()],w.prototype,"updating",null),w=(0,n.Cg)([(0,u.$)("esri.views.interactive.snapping.GridSnappingEngine")],w);const C=(e,t,r,n)=>{const i=(0,f.Hh)(e[0],e[1],e[2]);return(0,c.K)(i,(0,c.K)(i,i,r,t),r,n)},R=(e,t,r)=>{const n=(e[0]-r[0])/t,i=(e[1]-r[1])/t,o=Math.trunc(n),s=Math.trunc(i),l=Math.round(n%1),a=Math.round(i%1),u=r[0]+(o+l)*t,c=r[1]+(s+a)*t;return(0,f.vt)(u,c)},P=(e,t,r,n,i)=>{if(n<=0)return{shouldSnapX:!1,shouldSnapY:!1};const o=(e[0]-t[0])/n,s=(e[1]-t[1])/n;return{shouldSnapX:Math.abs(o*i)<r,shouldSnapY:Math.abs(s*i)<r}},x=(e,t,r,n)=>{if("y"===n){const n=t[0]>e[0]?1:-1;return(0,f.vt)(e[0]+r*n,e[1])}const i=t[1]>e[1]?1:-1;return(0,f.vt)(e[0],e[1]+r*i)}}}]);
//# sourceMappingURL=95393.d613a0b2.chunk.js.map